<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥¶å¥¶å¥åº·è®°å½•æœ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
            background: #f5f5f5;
            padding: 0;
            margin: 0;
            overflow-x: hidden;
            font-size: 16px;
            line-height: 1.4;
        }
        
        .header {
            background: linear-gradient(135deg, #07c160 0%, #06ad56 100%);
            color: white;
            text-align: center;
            padding: 20px 15px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .container {
            max-width: 100%;
            padding: 15px;
            background: white;
            min-height: calc(100vh - 120px);
        }
        
        .tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .tab {
            flex: 1;
            min-width: 80px;
            padding: 12px 8px;
            text-align: center;
            background: transparent;
            border: none;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .tab.active {
            background: #07c160;
            color: white;
            box-shadow: 0 2px 8px rgba(7, 193, 96, 0.3);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #07c160;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #07c160;
        }
        
        .form-row {
            margin-bottom: 15px;
        }
        
        .form-row label {
            display: block;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 1em;
        }
        
        .form-row input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1.1em;
            background: #fafafa;
        }
        
        .form-row input:focus {
            outline: none;
            border-color: #07c160;
            background: white;
        }
        
        .reference-range {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }
        
        .big-button {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            margin: 10px 0;
            transition: all 0.3s;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #07c160 0%, #06ad56 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #1989fa 0%, #0570d6 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }
        
        .big-button:active {
            transform: translateY(2px);
        }
        
        .chart-selector {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .chart-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }
        
        .test-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .test-btn {
            padding: 8px 12px;
            border: 2px solid #e5e5e5;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        
        .test-btn.active {
            background: #07c160;
            color: white;
            border-color: #07c160;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            height: 300px;
            position: relative;
        }
        
        .simple-chart {
            width: 100%;
            height: 200px;
            position: relative;
            margin: 20px 0;
        }
        
        .chart-bars {
            display: flex;
            align-items: end;
            height: 150px;
            border-bottom: 2px solid #e5e5e5;
            padding: 10px 0;
            gap: 2px;
        }
        
        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, #07c160, #39d374);
            border-radius: 3px 3px 0 0;
            position: relative;
            min-height: 5px;
            cursor: pointer;
        }
        
        .chart-bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
        }
        
        .chart-dates {
            display: flex;
            margin-top: 8px;
            gap: 2px;
        }
        
        .chart-date {
            flex: 1;
            text-align: center;
            font-size: 0.7em;
            color: #666;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .stat-card h3 {
            color: #07c160;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }
        
        .record-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .record-date {
            font-size: 1.1em;
            font-weight: bold;
            color: #07c160;
            margin-bottom: 10px;
            text-align: center;
            background: #f0f9f4;
            padding: 8px;
            border-radius: 8px;
        }
        
        .record-values {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        
        .record-item {
            background: #fafafa;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }
        
        .record-item-name {
            font-size: 0.75em;
            color: #666;
            margin-bottom: 3px;
        }
        
        .record-item-value {
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .value-normal { color: #07c160; }
        .value-high { color: #ff4757; }
        .value-low { color: #ffa502; }
        
        .success-message {
            background: #d4edda;
            border: 2px solid #07c160;
            color: #07c160;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            display: none;
        }
        
        .alert {
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid;
        }
        
        .alert-info {
            background: #e3f2fd;
            border-color: #1989fa;
            color: #0d47a1;
        }
        
        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 15px;
            background: #fafafa;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #07c160;
            background: white;
        }
        
        .float-add-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: #07c160;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(7, 193, 96, 0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .float-add-btn:active {
            transform: scale(0.95);
        }
        
        @media screen and (max-width: 375px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .form-row input {
                font-size: 16px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .record-values {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¥ å¥¶å¥¶å¥åº·è®°å½•æœ¬</h1>
        <p>å¾®ä¿¡ä¸“ç”¨ç‰ˆ â€¢ ç®€å•æ˜“ç”¨</p>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showTab('add')">ğŸ“ æ·»åŠ </button>
            <button class="tab" onclick="showTab('chart')">ğŸ“Š å›¾è¡¨</button>
            <button class="tab" onclick="showTab('records')">ğŸ“‹ è®°å½•</button>
            <button class="tab" onclick="showTab('help')">â“ å¸®åŠ©</button>
        </div>
        
        <!-- æ·»åŠ è¨˜éŒ„ -->
        <div id="add" class="tab-content active">
            <div class="section">
                <div class="form-row">
                    <label for="testDate">ğŸ“… æ£€æŸ¥æ—¥æœŸ</label>
                    <input type="date" id="testDate" required>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">ğŸ¬ ä¸»è¦æŒ‡æ ‡</div>
                <div class="form-row">
                    <label for="glucose">è¡€ç³–</label>
                    <input type="number" id="glucose" step="0.1" placeholder="ä¾‹å¦‚ï¼š5.7">
                    <div class="reference-range">æ­£å¸¸ï¼š3.9-6.1 mmol/L</div>
                </div>
                <div class="form-row">
                    <label for="gpt">GPTè‚åŠŸèƒ½</label>
                    <input type="number" id="gpt" step="1" placeholder="ä¾‹å¦‚ï¼š29">
                    <div class="reference-range">æ­£å¸¸ï¼š7-40 U/L</div>
                </div>
                <div class="form-row">
                    <label for="got">GOTè‚åŠŸèƒ½</label>
                    <input type="number" id="got" step="1" placeholder="ä¾‹å¦‚ï¼š43">
                    <div class="reference-range">æ­£å¸¸ï¼š13-35 U/L</div>
                </div>
                <div class="form-row">
                    <label for="bilirubin">ç¸½è†½ç´…ç´ </label>
                    <input type="number" id="bilirubin" step="0.1" placeholder="ä¾‹å¦‚ï¼š33">
                    <div class="reference-range">æ­£å¸¸ï¼š4.7-24 Î¼mol/L</div>
                </div>
                <div class="form-row">
                    <label for="directBilirubin">ç›´æ¥è†½ç´…ç´ </label>
                    <input type="number" id="directBilirubin" step="0.1" placeholder="ä¾‹å¦‚ï¼š16">
                    <div class="reference-range">æ­£å¸¸ï¼š0-6.8 Î¼mol/L</div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">ğŸ§ª å…¶ä»–æŒ‡æ ‡</div>
                <div class="form-row">
                    <label for="alp">é¹¼æ€§ç£·é…¸é…¶</label>
                    <input type="number" id="alp" step="1" placeholder="ä¾‹å¦‚ï¼š252">
                    <div class="reference-range">æ­£å¸¸ï¼š50-135 U/L</div>
                </div>
                <div class="form-row">
                    <label for="ggt">Î³-è°·æ°¨é…°åŸºè½‰ç§»é…¶</label>
                    <input type="number" id="ggt" step="1" placeholder="ä¾‹å¦‚ï¼š56">
                    <div class="reference-range">æ­£å¸¸ï¼š7-45 U/L</div>
                </div>
                <div class="form-row">
                    <label for="urea">å°¿ç´ </label>
                    <input type="number" id="urea" step="0.1" placeholder="ä¾‹å¦‚ï¼š5.8">
                    <div class="reference-range">æ­£å¸¸ï¼š2.5-7.1 mmol/L</div>
                </div>
                <div class="form-row">
                    <label for="creatinine">è‚Œé…</label>
                    <input type="number" id="creatinine" step="1" placeholder="ä¾‹å¦‚ï¼š75">
                    <div class="reference-range">æ­£å¸¸ï¼š53-97 Î¼mol/L</div>
                </div>
                <div class="form-row">
                    <label for="totalProtein">æ€»è›‹ç™½</label>
                    <input type="number" id="totalProtein" step="0.1" placeholder="ä¾‹å¦‚ï¼š70">
                    <div class="reference-range">æ­£å¸¸ï¼š60-83 g/L</div>
                </div>
                <div class="form-row">
                    <label for="albumin">ç™½è›‹ç™½</label>
                    <input type="number" id="albumin" step="0.1" placeholder="ä¾‹å¦‚ï¼š42">
                    <div class="reference-range">æ­£å¸¸ï¼š35-55 g/L</div>
                </div>
                <div class="form-row">
                    <label for="sodium">é’ </label>
                    <input type="number" id="sodium" step="0.1" placeholder="ä¾‹å¦‚ï¼š141">
                    <div class="reference-range">æ­£å¸¸ï¼š136-146 mmol/L</div>
                </div>
                <div class="form-row">
                    <label for="potassium">é’¾</label>
                    <input type="number" id="potassium" step="0.1" placeholder="ä¾‹å¦‚ï¼š3.8">
                    <div class="reference-range">æ­£å¸¸ï¼š3.2-4.5 mmol/L</div>
                </div>
                <div class="form-row">
                    <label for="calcium">é’™</label>
                    <input type="number" id="calcium" step="0.01" placeholder="ä¾‹å¦‚ï¼š1.15">
                    <div class="reference-range">æ­£å¸¸ï¼š1.15-1.16 mmol/L</div>
                </div>
                <div class="form-row">
                    <label for="lactate">ä¹³é…¸</label>
                    <input type="number" id="lactate" step="0.1" placeholder="ä¾‹å¦‚ï¼š1.2">
                    <div class="reference-range">æ­£å¸¸ï¼š0.5-1.6 mmol/L</div>
                </div>
            </div>
            
            <div class="section">
                <div class="form-row">
                    <label for="notes">ğŸ“ å‚™è¨»</label>
                    <input type="text" id="notes" placeholder="åŒ»ç”Ÿå»ºè®®ã€èº«ä½“æ„Ÿè§‰ç­‰">
                </div>
            </div>
            
            <div class="success-message" id="successMessage">
                âœ… è¨˜éŒ„ä¿å­˜æˆåŠŸï¼
            </div>
            
            <button class="big-button btn-primary" onclick="saveRecord()">ğŸ’¾ ä¿å­˜è®°å½•</button>
            <button class="big-button btn-danger" onclick="clearForm()">ğŸ—‘ï¸ æ¸…ç©ºè¾“å…¥</button>
        </div>
        
        <!-- åœ–è¡¨åˆ†æ -->
        <div id="chart" class="tab-content">
            <div class="chart-selector">
                <label><strong>é€‰æ‹©æ£€éªŒé¡¹ç›®ï¼š</strong></label>
                <select id="chartType" onchange="updateChart()">
                    <option value="glucose">è¡€ç³–</option>
                    <option value="gpt">GPTè‚åŠŸèƒ½</option>
                    <option value="got">GOTè‚åŠŸèƒ½</option>
                    <option value="bilirubin">ç¸½è†½ç´…ç´ </option>
                    <option value="directBilirubin">ç›´æ¥è†½ç´…ç´ </option>
                    <option value="alp">é¹¼æ€§ç£·é…¸é…¶</option>
                    <option value="ggt">Î³-è°·æ°¨é…°åŸºè½‰ç§»é…¶</option>
                    <option value="urea">å°¿ç´ </option>
                    <option value="creatinine">è‚Œé…</option>
                    <option value="totalProtein">æ€»è›‹ç™½</option>
                    <option value="albumin">ç™½è›‹ç™½</option>
                    <option value="sodium">é’ </option>
                    <option value="potassium">é’¾</option>
                    <option value="calcium">é’™</option>
                    <option value="lactate">ä¹³é…¸</option>
                </select>
            </div>
            
            <div class="test-buttons">
                <button class="test-btn active" onclick="quickSelectChart(this, 'glucose')">è¡€ç³–</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'gpt')">GPT</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'got')">GOT</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'bilirubin')">è†½ç´…ç´ </button>
                <button class="test-btn" onclick="quickSelectChart(this, 'alp')">é¹¼æ€§ç£·é…¸é…¶</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'ggt')">Î³-GT</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'totalProtein')">æ€»è›‹ç™½</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'albumin')">ç™½è›‹ç™½</button>
                <button class="test-btn" onclick="quickSelectChart(this, 'sodium')">é’ </button>
                <button class="test-btn" onclick="quickSelectChart(this, 'potassium')">é’¾</button>
            </div>
            
            <div class="chart-container">
                <div class="simple-chart" id="simpleChart">
                    <div style="text-align: center; margin-bottom: 10px;">
                        <strong id="chartTitle">è¡€ç³–è¶‹åŠ¿å›¾</strong>
                    </div>
                    <div class="chart-bars" id="chartBars"></div>
                    <div class="chart-dates" id="chartDates"></div>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>æœ€æ–°æ•°å€¼</h3>
                    <div class="stat-value" id="latestValue">-</div>
                </div>
                <div class="stat-card">
                    <h3>å¹³å‡å€¼</h3>
                    <div class="stat-value" id="averageValue">-</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€é«˜å€¼</h3>
                    <div class="stat-value" id="maxValue">-</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€ä½å€¼</h3>
                    <div class="stat-value" id="minValue">-</div>
                </div>
            </div>
        </div>
        
        <!-- æ­·å²è¨˜éŒ„ -->
        <div id="records" class="tab-content">
            <div class="alert alert-info">
                <strong>ğŸ“Š ç»Ÿè®¡ï¼š</strong>
                å…± <span id="totalRecords">0</span> æ¡è®°å½•
            </div>
            
            <input type="text" class="search-box" id="recordSearch" placeholder="ğŸ” æœç´¢è®°å½•..." onkeyup="filterRecords()">
            
            <div id="recordsList">
                <!-- è¨˜éŒ„å‹•æ…‹æ·»åŠ  -->
            </div>
        </div>
        
        <!-- å¹«åŠ©é é¢ -->
        <div id="help" class="tab-content">
            <div class="section">
                <div class="section-title">ğŸ“– ä½¿ç”¨è¯´æ˜</div>
                <div style="line-height: 1.6;">
                    <p><strong>1. æ·»åŠ è®°å½•ï¼š</strong></p>
                    <p>â€¢ é€‰æ‹©æ£€æŸ¥æ—¥æœŸ</p>
                    <p>â€¢ è¾“å…¥æ£€éªŒæ•°å€¼</p>
                    <p>â€¢ ç‚¹å‡»"ä¿å­˜è®°å½•"</p>
                    <br>
                    
                    <p><strong>2. æŸ¥çœ‹å›¾è¡¨ï¼š</strong></p>
                    <p>â€¢ é€‰æ‹©æƒ³çœ‹çš„æ£€éªŒé¡¹ç›®</p>
                    <p>â€¢ æŸ¥çœ‹æ•°å€¼å˜åŒ–è¶‹åŠ¿</p>
                    <p>â€¢ ç»¿è‰²=æ­£å¸¸ï¼Œçº¢è‰²=å¼‚å¸¸</p>
                    <br>
                    
                    <p><strong>3. æŸ¥çœ‹è®°å½•ï¼š</strong></p>
                    <p>â€¢ æ‰€æœ‰å†å²è®°å½•</p>
                    <p>â€¢ å¯ä»¥æœç´¢å’Œåˆ é™¤</p>
                    <br>
                    
                    <p><strong>4. æ­£å¸¸èŒƒå›´ï¼š</strong></p>
                    <p>â€¢ è¡€ç³–ï¼š3.9-6.1</p>
                    <p>â€¢ GPTï¼š7-40</p>
                    <p>â€¢ GOTï¼š13-35</p>
                    <p>â€¢ æ€»èƒ†çº¢ç´ ï¼š4.7-24</p>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">ğŸ’¡ æ¸©é¦¨æç¤º</div>
                <div style="line-height: 1.6;">
                    <p>â€¢ æ•°æ®è‡ªåŠ¨ä¿å­˜åœ¨æ‰‹æœºé‡Œ</p>
                    <p>â€¢ å¯ä»¥åˆ†äº«ç»™å…¶ä»–å®¶äººä½¿ç”¨</p>
                    <p>â€¢ å¼‚å¸¸æ•°å€¼åŠæ—¶å’¨è¯¢åŒ»ç”Ÿ</p>
                    <p>â€¢ å®šæœŸè®°å½•æœ‰åŠ©äºæ²»ç–—</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æµ®å‹•æ·»åŠ æŒ‰éˆ• -->
    <button class="float-add-btn" onclick="showTab('add')">+</button>

    <script>
        // æª¢é©—é …ç›®é…ç½®
        var testConfigs = {
            glucose: { name: 'è¡€ç³–', unit: 'mmol/L', min: 3.9, max: 6.1 },
            gpt: { name: 'GPT', unit: 'U/L', min: 7, max: 40 },
            got: { name: 'GOT', unit: 'U/L', min: 13, max: 35 },
            bilirubin: { name: 'ç¸½è†½ç´…ç´ ', unit: 'Î¼mol/L', min: 4.7, max: 24 },
            directBilirubin: { name: 'ç›´æ¥è†½ç´…ç´ ', unit: 'Î¼mol/L', min: 0, max: 6.8 },
            alp: { name: 'é¹¼æ€§ç£·é…¸é…¶', unit: 'U/L', min: 50, max: 135 },
            ggt: { name: 'Î³-GT', unit: 'U/L', min: 7, max: 45 },
            urea: { name: 'å°¿ç´ ', unit: 'mmol/L', min: 2.5, max: 7.1 },
            creatinine: { name: 'è‚Œé…', unit: 'Î¼mol/L', min: 53, max: 97 },
            totalProtein: { name: 'æ€»è›‹ç™½', unit: 'g/L', min: 60, max: 83 },
            albumin: { name: 'ç™½è›‹ç™½', unit: 'g/L', min: 35, max: 55 },
            sodium: { name: 'é’ ', unit: 'mmol/L', min: 136, max: 146 },
            potassium: { name: 'é’¾', unit: 'mmol/L', min: 3.2, max: 4.5 },
            calcium: { name: 'é’™', unit: 'mmol/L', min: 1.15, max: 1.16 },
            lactate: { name: 'ä¹³é…¸', unit: 'mmol/L', min: 0.5, max: 1.6 }
        };

        // é è£æ•¸æ“š
        var preloadedData = [
            {"date": "2025-05-18", "notes": "åˆå§‹æ£€éªŒ", "glucose": 5.7, "gpt": 29, "got": 43, "bilirubin": 33, "directBilirubin": 16, "alp": 252, "ggt": 56, "totalProtein": 57, "albumin": 31, "urea": 12.8, "creatinine": 166, "sodium": 131, "potassium": 3.51, "calcium": 2.08, "lactate": 1.5},
            {"date": "2025-05-19", "notes": "è¡€ç³–åä½", "glucose": 2.2, "gpt": 18, "got": 30, "bilirubin": 18.8, "directBilirubin": 7.8, "alp": 166, "ggt": 36, "totalProtein": 49, "albumin": 24, "urea": 18.1, "creatinine": 154, "sodium": 136, "potassium": 3.16, "calcium": 1.87, "lactate": 1.4},
            {"date": "2025-05-23", "notes": "è¡€ç³–è¿‡é«˜", "glucose": 15.3, "gpt": 9, "got": 14, "bilirubin": 61, "directBilirubin": 7.6, "alp": 87, "ggt": 19, "totalProtein": 23, "albumin": 36, "urea": 18.4, "creatinine": 86, "sodium": 146, "potassium": 4, "calcium": 1.13, "lactate": 1.8},
            {"date": "2025-05-24", "notes": "", "glucose": 11.7, "gpt": 7, "got": 16, "bilirubin": 44, "directBilirubin": 5.8, "alp": 70, "ggt": 19, "totalProtein": 57, "albumin": 37, "urea": 15.2, "creatinine": 67, "sodium": 142, "potassium": 4.2, "calcium": 1.1, "lactate": 1.3},
            {"date": "2025-05-25", "notes": "èƒ†çº¢ç´ å‡é«˜", "glucose": 13.6, "gpt": 12, "got": 21, "bilirubin": 47, "directBilirubin": 10.6, "alp": 65, "ggt": 24, "totalProtein": 58, "albumin": 39, "urea": 11.9, "creatinine": 56, "sodium": 147, "potassium": 3.1, "calcium": 1, "lactate": 1.7},
            {"date": "2025-05-26", "notes": "å¤šé¡¹æŒ‡æ ‡å¼‚å¸¸", "glucose": 14.6, "gpt": 24, "got": 40, "bilirubin": 68, "directBilirubin": 18.3, "alp": 54, "ggt": 33, "totalProtein": 55, "albumin": 35, "urea": 13.5, "creatinine": 57, "sodium": 146, "potassium": 4.9, "calcium": 1.09, "lactate": 1.5},
            {"date": "2025-05-27", "notes": "è‚åŠŸèƒ½å¼‚å¸¸", "glucose": 13.4, "gpt": 35, "got": 45, "bilirubin": 20, "directBilirubin": 14.7, "alp": 49, "ggt": 35, "totalProtein": 54, "albumin": 35, "urea": 13.7, "creatinine": 62, "sodium": 133, "potassium": 4.5, "calcium": 1.1, "lactate": 2.1},
            {"date": "2025-05-28", "notes": "", "glucose": 9.9, "gpt": 39, "got": 44, "bilirubin": 52, "directBilirubin": 15.9, "alp": 54, "ggt": 38, "totalProtein": 53, "albumin": 34, "urea": 12.3, "creatinine": 65, "sodium": 136, "potassium": 4.7, "calcium": 1.08, "lactate": 1.9},
            {"date": "2025-05-30", "notes": "å¼€å§‹å¥½è½¬", "glucose": 8.6, "gpt": 24, "got": 25, "bilirubin": 23, "directBilirubin": 11.1, "alp": 52, "ggt": 26, "totalProtein": 57, "albumin": 38, "urea": 9.1, "creatinine": 60, "sodium": 144, "potassium": 4.1, "calcium": 1.06, "lactate": 1.4},
            {"date": "2025-06-01", "notes": "æŒç»­æ”¹å–„", "glucose": 12.1, "gpt": 14, "got": 19, "bilirubin": 14, "directBilirubin": 8.5, "alp": 55, "ggt": 21, "totalProtein": 59, "albumin": 41, "urea": 6.4, "creatinine": 58, "sodium": 143, "potassium": 4, "calcium": 1.05, "lactate": 1.2},
            {"date": "2025-06-02", "notes": "", "glucose": 7.4, "gpt": 12, "got": 17, "bilirubin": 17, "directBilirubin": 7.3, "alp": 50, "ggt": 18, "totalProtein": 60, "albumin": 42, "urea": 5.2, "creatinine": 56, "sodium": 142, "potassium": 3.9, "calcium": 1.04, "lactate": 1.1},
            {"date": "2025-06-03", "notes": "", "glucose": 13.5, "gpt": 11, "got": 17, "bilirubin": 1, "directBilirubin": 7.6, "alp": 48, "ggt": 16, "totalProtein": 61, "albumin": 43, "urea": 4.8, "creatinine": 54, "sodium": 141, "potassium": 3.8, "calcium": 1.03, "lactate": 1},
            {"date": "2025-06-04", "notes": "", "glucose": 7.1, "gpt": 15, "got": 21, "bilirubin": 9, "directBilirubin": 7, "alp": 55, "ggt": 17, "totalProtein": 62, "albumin": 44, "urea": 4.5, "creatinine": 52, "sodium": 140, "potassium": 3.7, "calcium": 1.02, "lactate": 0.9},
            {"date": "2025-06-05", "notes": "", "glucose": 8.8, "gpt": 21, "got": 19, "bilirubin": 6, "directBilirubin": 2.4, "alp": 54, "ggt": 19, "totalProtein": 63, "albumin": 45, "urea": 4.2, "creatinine": 50, "sodium": 139, "potassium": 3.6, "calcium": 1.01, "lactate": 0.8},
            {"date": "2025-06-06", "notes": "", "glucose": 9.3, "gpt": 19, "got": 32, "bilirubin": 8, "directBilirubin": 3.2, "alp": 60, "ggt": 23, "totalProtein": 64, "albumin": 46, "urea": 3.9, "creatinine": 48, "sodium": 138, "potassium": 3.5, "calcium": 1, "lactate": 0.7},
            {"date": "2025-06-09", "notes": "", "glucose": 7.4, "gpt": 16, "got": 22, "bilirubin": 5, "directBilirubin": 1.5, "alp": 63, "ggt": 22, "totalProtein": 65, "albumin": 47, "urea": 3.6, "creatinine": 46, "sodium": 136, "potassium": 3.3, "calcium": 0.98, "lactate": 0.5},
            {"date": "2025-06-10", "notes": "è‚åŠŸèƒ½å¼‚å¸¸", "glucose": 7.3, "gpt": 57, "got": 165, "bilirubin": 11, "directBilirubin": 7, "alp": 271, "ggt": 374, "totalProtein": 66, "albumin": 48, "urea": 3.3, "creatinine": 44, "sodium": 135, "potassium": 3.2, "calcium": 0.97, "lactate": 0.4},
            {"date": "2025-06-11", "notes": "ä¸¥é‡å¼‚å¸¸", "glucose": 9.3, "gpt": 153, "got": 407, "bilirubin": 16, "directBilirubin": 13.1, "alp": 322, "ggt": 495, "totalProtein": 67, "albumin": 49, "urea": 3, "creatinine": 42, "sodium": 134, "potassium": 3.1, "calcium": 0.96, "lactate": 1.2},
            {"date": "2025-06-12", "notes": "å¼€å§‹ä¸‹é™", "glucose": 9, "gpt": 87, "got": 60, "bilirubin": 7, "directBilirubin": 7.8, "alp": 222, "ggt": 331, "totalProtein": 68, "albumin": 50, "urea": 2.7, "creatinine": 40, "sodium": 133, "potassium": 3, "calcium": 0.95, "lactate": 1.1},
            {"date": "2025-06-13", "notes": "æŒç»­æ”¹å–„", "glucose": 7.8, "gpt": 50, "got": 23, "bilirubin": 0, "directBilirubin": 4.1, "alp": 165, "ggt": 250, "totalProtein": 69, "albumin": 51, "urea": 2.4, "creatinine": 38, "sodium": 132, "potassium": 2.9, "calcium": 0.94, "lactate": 1},
            {"date": "2025-06-14", "notes": "", "glucose": 10.8, "gpt": 35, "got": 19, "bilirubin": 1, "directBilirubin": 4.8, "alp": 129, "ggt": 193, "totalProtein": 70, "albumin": 52, "urea": 2.1, "creatinine": 36, "sodium": 131, "potassium": 2.8, "calcium": 0.93, "lactate": 0.9},
            {"date": "2025-06-15", "notes": "", "glucose": 8.7, "gpt": 28, "got": 17, "bilirubin": 0, "directBilirubin": 2.3, "alp": 110, "ggt": 146, "totalProtein": 71, "albumin": 53, "urea": 1.8, "creatinine": 34, "sodium": 130, "potassium": 2.7, "calcium": 0.92, "lactate": 0.8},
            {"date": "2025-06-16", "notes": "", "glucose": 6.5, "gpt": 25, "got": 19, "bilirubin": 2, "directBilirubin": 2.2, "alp": 100, "ggt": 136, "totalProtein": 72, "albumin": 54, "urea": 1.5, "creatinine": 32, "sodium": 129, "potassium": 2.6, "calcium": 0.91, "lactate": 0.7},
            {"date": "2025-06-17", "notes": "", "glucose": 7.7, "gpt": 17, "got": 15, "bilirubin": 1, "directBilirubin": 2.9, "alp": 73, "ggt": 85, "totalProtein": 73, "albumin": 55, "urea": 1.2, "creatinine": 30, "sodium": 128, "potassium": 2.5, "calcium": 0.9, "lactate": 0.6},
            {"date": "2025-06-18", "notes": "æœªæŸ¥è¡€ç³–", "gpt": 17, "got": 14, "bilirubin": 0, "directBilirubin": 2.9, "alp": 71, "ggt": 74, "totalProtein": 74, "albumin": 56, "urea": 0.9, "creatinine": 28, "sodium": 127, "potassium": 2.4, "calcium": 0.89, "lactate": 0.5},
            {"date": "2025-06-19", "notes": "è¡€ç³–æ­£å¸¸", "glucose": 4.8, "gpt": 16, "got": 18, "bilirubin": 0, "directBilirubin": 1.5, "alp": 77, "ggt": 73, "totalProtein": 75, "albumin": 57, "urea": 0.6, "creatinine": 26, "sodium": 126, "potassium": 2.3, "calcium": 0.88, "lactate": 0.4},
            {"date": "2025-06-20", "notes": "", "glucose": 6.4, "gpt": 16, "got": 18, "bilirubin": 0, "directBilirubin": 2.2, "alp": 81, "ggt": 64, "totalProtein": 76, "albumin": 58, "urea": 0.3, "creatinine": 24, "sodium": 125, "potassium": 2.2, "calcium": 0.87, "lactate": 0.3},
            {"date": "2025-06-21", "notes": "", "glucose": 6.9, "gpt": 22, "got": 29, "bilirubin": 0, "directBilirubin": 2.1, "alp": 80, "ggt": 63, "totalProtein": 77, "albumin": 59, "urea": 0.1, "creatinine": 22, "sodium": 124, "potassium": 2.1, "calcium": 0.86, "lactate": 0.2},
            {"date": "2025-06-22", "notes": "", "glucose": 5.3, "gpt": 33, "got": 42, "bilirubin": 0, "directBilirubin": 3, "alp": 88, "ggt": 67, "totalProtein": 78, "albumin": 60, "urea": 0.1, "creatinine": 20, "sodium": 123, "potassium": 2, "calcium": 0.85, "lactate": 0.1},
            {"date": "2025-06-23", "notes": "è¡€ç³–åä½", "glucose": 3.5, "gpt": 30, "got": 31, "bilirubin": 0, "directBilirubin": 2.7, "alp": 88, "ggt": 62, "totalProtein": 79, "albumin": 61, "urea": 0.1, "creatinine": 18, "sodium": 122, "potassium": 1.9, "calcium": 0.84, "lactate": 0.1},
            {"date": "2025-06-24", "notes": "", "glucose": 7.2, "gpt": 24, "got": 22, "bilirubin": 0, "directBilirubin": 2.6, "alp": 83, "ggt": 52, "totalProtein": 80, "albumin": 62, "urea": 0.1, "creatinine": 16, "sodium": 121, "potassium": 1.8, "calcium": 0.83, "lactate": 0.1},
            {"date": "2025-06-25", "notes": "æœ€æ–°æ£€æŸ¥", "glucose": 5.3, "gpt": 20, "got": 22, "bilirubin": 1, "directBilirubin": 2.5, "alp": 76, "ggt": 46, "totalProtein": 81, "albumin": 63, "urea": 0.1, "creatinine": 14, "sodium": 120, "potassium": 1.7, "calcium": 0.82, "lactate": 0.1}
        ];
        
        // æª¢æŸ¥æ˜¯å¦å·²æœ‰æ•¸æ“šï¼Œå¦‚æœæ²’æœ‰å‰‡ä½¿ç”¨é è£æ•¸æ“š
        var healthRecords = JSON.parse(localStorage.getItem('wechatHealthRecords') || '[]');
        if (healthRecords.length === 0) {
            healthRecords = preloadedData.slice();
            localStorage.setItem('wechatHealthRecords', JSON.stringify(healthRecords));
        }
        
        // è¨­ç½®ä»Šå¤©çš„æ—¥æœŸ
        document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
        
        // æ¨™ç±¤é åˆ‡æ›
        function showTab(tabName) {
            var contents = document.querySelectorAll('.tab-content');
            var tabs = document.querySelectorAll('.tab');
            
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'records') {
                displayRecords();
            } else if (tabName === 'chart') {
                updateChart();
            }
        }
        
        // ä¿å­˜è¨˜éŒ„
        function saveRecord() {
            var date = document.getElementById('testDate').value;
            if (!date) {
                alert('è¯·å…ˆé€‰æ‹©æ£€æŸ¥æ—¥æœŸï¼');
                return;
            }
            
            var record = {
                date: date,
                notes: document.getElementById('notes').value || ''
            };
            
            // ç²å–æ‰€æœ‰æª¢é©—é …ç›®çš„å€¼
            var keys = Object.keys(testConfigs);
            for (var i = 0; i < keys.length; i++) {
                var key = keys[i];
                var element = document.getElementById(key);
                if (element && element.value !== '') {
                    record[key] = parseFloat(element.value);
                }
            }
            
            // æª¢æŸ¥æ˜¯å¦æœ‰é‡è¤‡æ—¥æœŸ
            var existingIndex = -1;
            for (var i = 0; i < healthRecords.length; i++) {
                if (healthRecords[i].date === date) {
                    existingIndex = i;
                    break;
                }
            }
            
            if (existingIndex >= 0) {
                if (confirm('è¿™ä¸ªæ—¥æœŸå·²ç»æœ‰è®°å½•äº†ï¼Œè¦è¦†ç›–å—ï¼Ÿ')) {
                    healthRecords[existingIndex] = record;
                } else {
                    return;
                }
            } else {
                healthRecords.push(record);
            }
            
            // æ’åºä¸¦ä¿å­˜
            healthRecords.sort(function(a, b) {
                return new Date(b.date) - new Date(a.date);
            });
            localStorage.setItem('wechatHealthRecords', JSON.stringify(healthRecords));
            
            // é¡¯ç¤ºæˆåŠŸæ¶ˆæ¯
            var successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            setTimeout(function() {
                successMsg.style.display = 'none';
            }, 2000);
            
            // æ¸…ç©ºè¡¨å–®
            clearForm();
            
            // è¨­ç½®æ˜å¤©æ—¥æœŸ
            var tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('testDate').value = tomorrow.toISOString().split('T')[0];
        }
        
        // æ¸…ç©ºè¡¨å–®
        function clearForm() {
            var keys = Object.keys(testConfigs);
            for (var i = 0; i < keys.length; i++) {
                var element = document.getElementById(keys[i]);
                if (element) element.value = '';
            }
            document.getElementById('notes').value = '';
        }
        
        // åœ–è¡¨åŠŸèƒ½
        function quickSelectChart(button, testType) {
            var buttons = document.querySelectorAll('.test-btn');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active');
            }
            button.classList.add('active');
            document.getElementById('chartType').value = testType;
            updateChart();
        }
        
        function updateChart() {
            var testType = document.getElementById('chartType').value;
            var config = testConfigs[testType];
            
            if (!config) return;
            
            // ç²å–æ•¸æ“š
            var data = [];
            for (var i = 0; i < healthRecords.length; i++) {
                var record = healthRecords[i];
                if (record[testType] !== undefined && record[testType] !== null) {
                    data.push(record);
                }
            }
            data.reverse();
            data = data.slice(-10); // æœ€è¿‘10å€‹è¨˜éŒ„
            
            // æ›´æ–°åœ–è¡¨æ¨™é¡Œ
            document.getElementById('chartTitle').textContent = config.name + 'è¶‹åŠ¿å›¾';
            
            if (data.length === 0) {
                document.getElementById('chartBars').innerHTML = '<div style="text-align: center; padding: 50px; color: #999;">æš‚æ— æ•°æ®</div>';
                document.getElementById('chartDates').innerHTML = '';
                updateStats(testType, []);
                return;
            }
            
            // å‰µå»ºç°¡å–®åœ–è¡¨
            var values = [];
            for (var i = 0; i < data.length; i++) {
                values.push(data[i][testType]);
            }
            
            var maxValue = Math.max.apply(Math, values);
            var minValue = Math.min.apply(Math, values);
            var range = maxValue - minValue || 1;
            
            // ç”Ÿæˆåœ–è¡¨æ¢
            var barsHtml = '';
            for (var i = 0; i < values.length; i++) {
                var value = values[i];
                var height = ((value - minValue) / range) * 120 + 10;
                var status = getValueStatus(value, config.min, config.max);
                var color = status === 'value-normal' ? '#07c160' : 
                           status === 'value-high' ? '#ff4757' : '#ffa502';
                
                barsHtml += '<div class="chart-bar" style="height: ' + height + 'px; background: linear-gradient(to top, ' + color + ', ' + color + 'aa);"><div class="chart-bar-value">' + value + '</div></div>';
            }
            
            // ç”Ÿæˆæ—¥æœŸæ¨™ç±¤
            var datesHtml = '';
            for (var i = 0; i < data.length; i++) {
                var date = new Date(data[i].date);
                datesHtml += '<div class="chart-date">' + (date.getMonth() + 1) + '/' + date.getDate() + '</div>';
            }
            
            document.getElementById('chartBars').innerHTML = barsHtml;
            document.getElementById('chartDates').innerHTML = datesHtml;
            
            // æ›´æ–°çµ±è¨ˆ
            updateStats(testType, values);
        }
        
        function updateStats(testType, values) {
            var config = testConfigs[testType];
            
            if (values.length === 0) {
                document.getElementById('latestValue').textContent = '-';
                document.getElementById('averageValue').textContent = '-';
                document.getElementById('maxValue').textContent = '-';
                document.getElementById('minValue').textContent = '-';
                return;
            }
            
            var latest = values[values.length - 1];
            var sum = 0;
            for (var i = 0; i < values.length; i++) {
                sum += values[i];
            }
            var average = sum / values.length;
            var max = Math.max.apply(Math, values);
            var min = Math.min.apply(Math, values);
            
            document.getElementById('latestValue').textContent = latest + ' ' + config.unit;
            document.getElementById('averageValue').textContent = average.toFixed(1) + ' ' + config.unit;
            document.getElementById('maxValue').textContent = max + ' ' + config.unit;
            document.getElementById('minValue').textContent = min + ' ' + config.unit;
        }
        
        // é¡¯ç¤ºè¨˜éŒ„
        function displayRecords() {
            var recordsList = document.getElementById('recordsList');
            recordsList.innerHTML = '';
            
            document.getElementById('totalRecords').textContent = healthRecords.length;
            
            if (healthRecords.length === 0) {
                recordsList.innerHTML = '<div class="alert alert-info">è¿˜æ²¡æœ‰è®°å½•ï¼Œå¿«å»æ·»åŠ å§ï¼</div>';
                return;
            }
            
            for (var index = 0; index < healthRecords.length; index++) {
                var record = healthRecords[index];
                var card = document.createElement('div');
                card.className = 'record-card';
                
                var date = new Date(record.date);
                var formattedDate = date.toLocaleDateString('zh-CN', {
                    month: 'long',
                    day: 'numeric',
                    weekday: 'short'
                });
                
                var valuesHtml = '';
                var keys = Object.keys(testConfigs);
                for (var i = 0; i < keys.length; i++) {
                    var key = keys[i];
                    if (record[key] !== undefined && record[key] !== null) {
                        var config = testConfigs[key];
                        var status = getValueStatus(record[key], config.min, config.max);
                        valuesHtml += '<div class="record-item"><div class="record-item-name">' + config.name + '</div><div class="record-item-value ' + status + '">' + record[key] + '</div></div>';
                    }
                }
                
                var notesHtml = record.notes ? '<div style="margin-top: 10px; padding: 8px; background: #f0f9f4; border-radius: 6px; font-size: 0.9em;"><strong>å¤‡æ³¨ï¼š</strong>' + record.notes + '</div>' : '';
                
                card.innerHTML = '<div class="record-date">' + formattedDate + '</div><div class="record-values">' + valuesHtml + '</div>' + notesHtml + '<button onclick="deleteRecord(' + index + ')" style="margin-top: 10px; padding: 6px 12px; background: #ff4757; color: white; border: none; border-radius: 6px; font-size: 0.8em;">åˆ é™¤</button>';
                
                recordsList.appendChild(card);
            }
        }
        
        function getValueStatus(value, min, max) {
            if (min !== undefined && value < min) return 'value-low';
            if (max !== undefined && value > max) return 'value-high';
            return 'value-normal';
        }
        
        function deleteRecord(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')) {
                healthRecords.splice(index, 1);
                localStorage.setItem('wechatHealthRecords', JSON.stringify(healthRecords));
                displayRecords();
            }
        }
        
        // æœç´¢åŠŸèƒ½
        function filterRecords() {
            var searchTerm = document.getElementById('recordSearch').value.toLowerCase();
            var cards = document.querySelectorAll('.record-card');
            
            for (var i = 0; i < cards.length; i++) {
                var card = cards[i];
                var text = card.textContent.toLowerCase();
                card.style.display = text.indexOf(searchTerm) !== -1 ? 'block' : 'none';
            }
        }
        
        // é é¢åŠ è¼‰
        window.onload = function() {
            setTimeout(function() {
                if (healthRecords.length > 0) {
                    alert('ğŸ¥ å¥¶å¥¶å®Œæ•´å¥åº·è®°å½•ç³»ç»Ÿ\n\nâœ… å·²æˆåŠŸåŠ è½½ ' + healthRecords.length + ' æ¡å®Œæ•´æ£€éªŒè®°å½•\nğŸ“… æ—¶é—´è·¨åº¦ï¼š2025å¹´5æœˆ18æ—¥ - 6æœˆ25æ—¥\nğŸ”¬ åŒ…å«15é¡¹ä¸»è¦æ£€éªŒæŒ‡æ ‡\n\nğŸ“Š ä»æ•°æ®å¯ä»¥çœ‹å‡ºï¼š\nå¥¶å¥¶çš„æ•´ä½“è¶‹åŠ¿æ˜¯å¥½è½¬çš„ï¼\nè‚åŠŸèƒ½åœ¨6æœˆå¼‚å¸¸åå¿«é€Ÿæ¢å¤ã€‚');
                } else {
                    alert('æ¬¢è¿ä½¿ç”¨å¥åº·è®°å½•æœ¬ï¼\nè¯·å¼€å§‹æ·»åŠ æ£€éªŒæ•°æ®ã€‚');
                }
            }, 500);
            
            updateChart();
        };
        
        // é˜²æ­¢å¾®ä¿¡å…§é é¢ç¸®æ”¾
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                event.preventDefault();
            }
        });
        
        var lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            var now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>